<?php
|
|require_once('classes/class.housekeeping.php');
|?>
doctype html
html.no-js(lang='en-us')
	head
		meta(charset='utf-8')
		<!--[if IE]><meta http-equiv='X-UA-Compatible' content='IE=edge'><![endif]-->
		title I Endorse Nina Turner for Congress - Generate your own endorsement graphic & avatar
		link(rel="prefetch" href="//code.jquery.com")
		meta(name='description' content='Generate your own Nina Turner endorsement graphic & avatar')
		meta(name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover")
		meta(name="supported-color-schemes" content="light dark")
		<link rel="preconnect" href="https://fonts.gstatic.com"> 
		<link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,800;1,400&display=swap" rel="stylesheet">
		link(rel='stylesheet' href='css/normalize.css')
		link(rel='stylesheet' href='css/main.css')

		//- REMINDER: DASH AFTER SLASH-SLASH HIDES COMMENTS FROM PUG COMPILER

	body
		header
			section: article.textual
				h1
					include nina.svg
				aside Generate images for social media to show your support!


		<!--[if lt IE 9]>
			p.browserupgrade
				| You are using an #[strong outdated] browser. Please
				|
				a(href="http://browsehappy.com/") upgrade your browser
				|  to improve your experience.
		<![endif]-->
		main

			section: article.textual
				p Our Revolution supports Nina Turner â€”Â now you can show that you support her as well! Nina is running for congress in Ohio's 11th district to replace the seat to be vacated by Marica L. Fudge. Let's do everything we can to send this progressive champion to Washington!

				p Fill in the info, upload your photo, and generate your images to share on Instagram, Facebook, and Twitter. Be sure to use the hashtag <b>#IEndorseNina</b>!

				.flexbox
					.ksflex.half

						form.generator

							div: label
								| First Name
							input#firstname-input(type='text', maxlength="18" value!="<?php echo htmlspecialchars(housekeeping::get('firstname')); ?>")
							
							div: label
								| Last Name
							input#lastname-input(type='text', maxlength="30" value!="<?php echo htmlspecialchars(housekeeping::get('lastname')); ?>")

							div: label
								| Where do you live?
							input#where-input(type='text', maxlength="50" value!="<?php echo htmlspecialchars(housekeeping::get('where')); ?>")

							div: label
								| Square Image Variant â€¦
							<?php
							|	$variant = housekeeping::get('v');
							|	for($i = 1 ; $i <= 7 ; $i++) {
							|		echo('<label>');			
							|		echo('<input type="radio" name="variant" value="' . $i . '" ');
							|		echo housekeeping::checkedIf($i == $variant || ('' == $variant && $i == 1));
							|		echo ' />';
							|		echo '<img class="background-thumbnail" src="img/thumb/square-thumb' . $i . '.jpg" />';
							|		echo '</label>';
							|	}
							|?>

							div: label
								| Why are you endorsing her? Pick something here â€¦
							select#reason-select(name="reason", style="width:100%")
								option(value="") --- Some suggestions ---
								option(value="1")  Sheâ€™s not afraid of a righteous fight!
								option(value="2")  She speaks the truth, is fierce and loving.
								option(value="3")  Nina Turner has no patience for half measures!
								option(value="4")  I trust her 100%. She speaks from heart and mind.
								option(value="5")  We need another member of â€˜the squadâ€™ in Congress!
								option(value="6")  Nina Turner is the leading revolutionary spirit of our time.
								option(value="7")  Sheâ€™ll fight to dismantle our racist Criminal Justice System.
								option(value="8")  Nina has the political will, determination and imagination we need.
								option(value="9")  Nina considers herself a â€˜hellraising humanitarian.â€™ HelloÂ Somebody!
								option(value="10") Nina will always fight for the people with 100% passion and commitment.
								option(value="11") Nina Turner has the qualities we desperately need in our leaders right now.
								option(value="12") She could spend as much time in congress as Bernie and remain uncorrupted.
								option(value="13") The people of Ohio District 11 deserve a government that works for everybody.
								option(value="14") Sheâ€™ll work to pass a Peopleâ€™s Stimulus because our people need it for survival!
								option(value="15") Nina Turner is willing to speak up for the regular people when so many others wonâ€™t.
								option(value="16") Ohio and the entire country need Ninaâ€™s passion and voice to fight for ordinary people.
								option(value="17") I support Nina because she isnâ€™t afraid to take on powers that be and fight for the people
								option(value="18") She will not equivocate on issues like Medicare For All, Criminal Justice Reform and a Green New Deal.
								option(value="19") Nina will fight for A Green New Deal, Medicare For All, Criminal Justice Reform, and Ending Corporate Greed.
								option(value="20") Hello somebody! Itâ€™s time to elect leaders with the backbone to stand for those of us that are not millionaires or billionaires!
								option(value="21") She is for the working class and â€˜the almost middle classâ€™ and includes those in our communities who cannot fend for themselves.
								option(value="22") Her solutions to the major problems that we have in this country are crystal clear. She deserves a National platform in order to implement her proposals.
								option(value="23") We need a true progressive voice in Washington DC that is willing to fight for the 99% and stand with Senator Sanders even when it's not popular within the Democratic establishment.
								option(value="24") Nina understands we can never go â€˜back to normal.â€™ Normal gave us a knee on George Floydâ€™s neck. Normal means 40% of us canâ€™t afford a $400 emergency. Normal means 44 million Americans having their dreams crushed by student debt.
								option(value="25") Congress needs elected officials who aren't afraid to fight for a better quality of life for all Americans. Nina Turner has proven that she is a warrior we can trust, regardless of geographic location or any of the things that tend to divide us.
								option(value="26") I am supporting Nina because our government has sold â€˜We the Peopleâ€™ out. They ignore our needs while, at the same time are being bribed to transfer billions to their wealthy donors. They get rich while we lose everything. Nina will fight to change that!
							div: label
								| â€¦ Or, write your own personal message
							textarea#freeform-text(name="freeform")
							p.small: i Suggestion: include your message when you share your image, along with <b>#IEndorseNina</b>

							div: label
								.hidden-ios
									img#avatarImage(src='img/avatar.png')
								| Photo of you
							input.filebutton#uploadAvatar(type='file' value='upload image' onchange='readURL(this);')


							div
								// if 'test' parameter set to a true value, then hidden input here allows missing avatar upload.
								<?php if (housekeeping::isGet('test')) { ?><input type="hidden" id="test-input" value="1" name="test" /> <?php } ?>
								input.button#generate(type='submit' value='Generate images')

					.ksflex.half#canvasContainer

						div.initiallyHidden(style='display:none')
							p
								|Images have been generated!
								.visible-ios
									b Tap and hold on images to save in your photo library.
								
						div.placeholder.supertitle Example RECT image for Twitter
						canvas#rectCanvas(width='1200' height='630' style='display:none')
						img#rectImg.placeholder(src='img/rect-example.jpg')
						div.download-container.initiallyHidden(style='display:none')
							img.resultImage#rectResult
							span.supertitle for Twitter
							a.download.hidden-ios.button#downloadRect(href="#", data-shape='rect') Download

						div.placeholder.supertitle Example SQUARE image for FaceBook & Instagram
						canvas#squareCanvas(width='1080' height='1080' style='display:none')
						img#squareImg.placeholder(src='img/square-example.jpg')
						div.download-container.initiallyHidden(style='display:none')
							img.resultImage#squareResult
							span.supertitle for Facebook & Instagram
							a.download.hidden-ios.button#downloadSquare(href="#", data-shape='square') Download

						div.placeholder.supertitle Example social media avatar
						canvas#iconCanvas(width='600' height='600' style='max-width:300px; display:none;  border:1px solid rgba(128,128,128,0.3)')
						img#iconImg.placeholder(src='img/profile-example.png' style='max-width:300px; display:block; margin:0 auto')

						div.download-container.initiallyHidden(style='display:none')
							img.resultImage#iconResult(style='max-width:300px; display:block; margin:0 auto')
							span.supertitle Social Media Avatar
							a.download.hidden-ios.button#downloadIcon(href="#", data-shape='icon') Download

						div.initiallyHidden(style='display:none')

							p
								|Share your customized graphics and experiences by using #IEndorseNina and tagging us on social media!
								br
								|Twitter: @IEndorseNina

							p(style='font-size:80%')
								<b>Having problems?</b> If the fonts aren't quite right, try re-generating your image. And certain photos taken with your phone's camera may be rotated incorrectly depending on the orientation of your phone. Try taking a new photo with your phone oriented on a different side.

			section.js-warning This page requires JavaScript! 

		footer
			p.
				For personal use and personal images only. No personal or demographic information is transmitted to, or collected by, this website. Any usage information collected will be used only for general analytics.
			p.
				Created WITH THESE HANDS ðŸ™Œ by <a href='https://twitter.com/danwood'>Dan Wood</a> and âœŠ <a href='https://ourrevolution.com'>Our Revolution</a>. Also, thanks to the <a href='https://www.facebook.com/groups/ninaforcongress'>Nina for Congress</a> Facebook group for suggestions. ðŸ––
			p.
				Questions? Contact <a href='https://twitter.com/iendorsenina'>@IEndorseNina</a> on Twitter.
 
		//- End scripts

		script(src='https://code.jquery.com/jquery-3.5.1.min.js' integrity='sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2' crossorigin='anonymous')
		script.
			window.jQuery || document.write('<script src="js/vendor/jquery-3.5.1.min.js"><\\/script>')
		script(src='js/plugins-min.js')
		script(src='js/main-min.js')
		//- Modernizer-like: Remove "no-js" class from element, if it exists
		script.
			document.documentElement.className = document.documentElement.className.replace("no-js","js");

			// Set body class to iPhone, iPad, or other
			var bodyClass = 'other'
			if (navigator.userAgent.includes('iPhone')) bodyClass = 'iPhone';
			if (navigator.userAgent.includes('iPad')  ) bodyClass = 'iPad';
			document.body.className = bodyClass;

			//- Download canvas as a PNG image
			//- https://stackoverflow.com/questions/10673122/how-to-save-canvas-as-an-image-with-canvas-todataurl#answer-44487883

			$(".download").on('click', function() {

				var shape = $(this).data('shape');
				var canvas = document.getElementById(shape + 'Canvas');

				$(this).attr('download', 'I-Endorse-Nina-' + shape + '.png');
				$(this).attr('href', canvas.toDataURL("image/png").replace("image/png", "image/octet-stream"));
			});

			<?php if (!empty(housekeeping::get('reason'))) { ?>
			$("#reason-select").val(<?php echo htmlspecialchars(housekeeping::get('reason')); ?>);
			<?php } ?>

			$( "#reason-select" ).change(function() {
				var str = "";
				$( "select option:selected" ).each(function() {
				  if ($(this).val() !== '') {
				    str += $( this ).text() + " ";
				  }
				});
				$("#freeform-text").text(str.trim())
			})
			.change();

			$("#generate").on('click', function() {

				// Set globals

				firstname = $('#firstname-input').val().trim();
				lastname = $('#lastname-input').val().trim();
				where = $('#where-input').val().trim();
				reason = $('#freeform-text').val();
				variantNumber = $("input[name='variant']:checked").val();

				$("#myform input[type='radio']:checked")

				fullname = (firstname + " " + lastname).trim()

				avatarImageSrc = $("#avatarImage").attr('src');

				if (firstname.length < 2 || where.length < 2 || reason.length < 10) {
					alert("Please fill in, at least, your first name and location and a reason");
				}
				else if ((avatarImageSrc === undefined || avatarImageSrc == 'img/avatar.png') && $('#test-input').val() != 1) {
					alert("You need to upload your image!");
				}
				else {
					startGeneratingImage();
				}

				return false;
			});

			//- Load file locally
			//- https://stackoverflow.com/questions/19183180/how-to-save-an-image-to-localstorage-and-display-it-on-the-next-page

			function readURL(input) 
			{
				if (input.files && input.files[0]) {
					var reader = new FileReader();

					reader.onload = function (e) {
						$("#avatarImage").attr('src', e.target.result);
					}

					reader.readAsDataURL(input.files[0]);
				}
			}




